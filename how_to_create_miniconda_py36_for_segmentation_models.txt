Create Miniconda Python3.6x environment for segmentation_models

/data/HiTIF/progs/miniconda/miniconda2/bin/conda create -n segmentation_model python=3.6 tensorflow=1.9.0 numpy pandas seaborn matplotlib hdf5 h5py pyarrow tensorflow-gpu=1.9.0 packaging

source /data/HiTIF/progs/miniconda/miniconda2/bin/activate segmentation_model
pip install git+https://github.com/qubvel/segmentation_models
pip install git+https://github.com/aleju/imgaug

#These two modules on Biowulf might be optional
module load CUDA/9.0 cuDNN/7.2/CUDA/9.0
# Otherwise TF will occupy all GPUs on multi-gpu compute node.
export CUDA_VISIBLE_DEVICES=0

# Test Tensorflow GPU and Keras Backend
python

import keras
import tensorflow as tf

# Creates a graph.
a = tf.constant([1.0, 2.0, 3.0, 4.0, 5.0, 6.0], shape=[2, 3], name='a')
b = tf.constant([1.0, 2.0, 3.0, 4.0, 5.0, 6.0], shape=[3, 2], name='b')
c = tf.matmul(a, b)
# Creates a session with log_device_placement set to True.
sess = tf.Session(config=tf.ConfigProto(log_device_placement=True))
# Runs the op.
print(sess.run(c))

## How to run FPN
<biowulf>
sinteractive --constraint=gpup100 --gres=gpu:p100:4,lscratch:400  --cpus-per-task=32 --mem=120g -t 1-12
<cnxxxx>
module load CUDA/9.2 cuDNN/7.5/CUDA-9.2
#cd /data/HiTIF/progs/miniconda/miniconda2
module load CUDA/9.2 cuDNN/7.5/CUDA-9.2
source /data/HiTIF/progs/miniconda/miniconda2/bin/activate segmentation_model

cd /gpfs/gsfs10/users/HiTIF/progs/dl_segmentation/segmentation_models/scripts_for_augmenteddata/version2.0
export CUDA_VISIBLE_DEVICES=0; python -u ./train_unetfpn_mask.py >& ./logs/train_unetfpn_mask.log &
export CUDA_VISIBLE_DEVICES=0; python -u ./train_unetfpn_edt.py >& ./logs/train_unetfpn_edt.log &
export CUDA_VISIBLE_DEVICES=1; python -u ./train_unetfpn_outline.py >& ./logs/train_unetfpn_outline.log &

export CUDA_VISIBLE_DEVICES=0; python -u ./train_unetfpn_gaussianblur.py >& ./logs/train_unetfpn_gaussianblur.log &

# Plotting the inference
export CUDA_VISIBLE_DEVICES=0; python -u ./plot_prediction.py



module load CUDA/9.2 cuDNN/7.5/CUDA-9.2
source /data/HiTIF/progs/miniconda/miniconda2/bin/activate segmentation_model
cd /gpfs/gsfs10/users/HiTIF/data/dl_segmentation_paper/code/python/unet_fpn

export CUDA_VISIBLE_DEVICES=0,1,2,3; python -u /gpfs/gsfs10/users/HiTIF/data/dl_segmentation_paper/code/python/unet_fpn/train_test_unets_fpns.py >& /gpfs/gsfs10/users/HiTIF/data/dl_segmentation_paper/code/python/unet_fpn/logs/train_test_unets_fpns.log &